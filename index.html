<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mémoire de Madame de Mornay</title>
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="assets/papaparse.min.js"></script>
    <script src="assets/script.js"></script>
</head>

<body>
    <h1>Mémoires de Madame de Mornay</h1>
    <div class="book">
        <div class="book__page">
            <div class="book__page__text">
                Est exercitation dolor deserunt fugiat anim et tempor aliqua. Nisi aliquip adipisicing proident ex
                occaecat enim veniam et proident dolor id reprehenderit. Consectetur sunt velit labore do non occaecat.
                Minim sit eiusmod nulla voluptate consequat ex reprehenderit nostrud aute. Aute proident aliquip
                pariatur proident. Amet labore dolore culpa non non ex consectetur id ullamco exercitation quis sunt.
                Culpa minim deserunt laborum fugiat ullamco aliquip.
            </div>
        </div>
        <div class="book__page">
            <div id="mapid" class="book__page__map"></div>
        </div>
    </div>
    <script>
        // initialize Leaflet
        var map = L.map('mapid').setView([46, 2], 5);

        // add the OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
        }).addTo(map);

        // show the scale bar on the lower left corner
        L.control.scale().addTo(map);

        // Read markers data from data.csv
        $.get('assets/data/dev_data_locations.csv', function (csvString) {

            // Use PapaParse to convert string to array of objects
            var data = Papa.parse(csvString, {
                header: true,
                endoding: "fr",
                transform: function (h) {
                    return h.replace(',', '.')
                },
                dynamicTyping: true
            }).data;

            console.log(data);
            // For each row in data, create a marker and add it to the map
            // For each row, columns `lat`, `lng`, and `city` are required
            for (var i in data) {
                var row = data[i];


                if (row.page == null ) {
                    var marker = L.marker([row.lat, row.lng], {
                    opacity: 1
                    }).bindPopup(row.city + '<br>' + row.subject);


                } else {
                    var marker = L.marker([row.lat, row.lng], {
                    opacity: 1
                    }).bindPopup(row.city + '<br>' + row.subject + '<br>' + row.page);


                };

                marker.addTo(map);
            }

        });
    </script>
</body>

</html>